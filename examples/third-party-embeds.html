<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>RedBlue Annotations: Third-Party Embeds</title>
    <style>
      .logotype {
        margin-top: -40px;
        font-family: 'Accord Alternate', 'HelveticaNeue-Light', 'Helvetica Neue Light', 'Helvetica Neue', Helvetica, Arial, 'Lucida Grande', sans-serif;
        font-size: 2.5rem;
        margin-bottom: .5rem;
        font-weight: 600;
        line-height: 1.1;
        /* height: 2.75rem; */
        /* overflow: hidden; */
      }

      .logotype > span {
        font-weight: normal;
        letter-spacing: -.05rem;
      }
    </style>
    <link rel="stylesheet" href="index.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-light.min.css" media="none" onload="if(media!=='all')media='all'" />
  </head>
  <body>
    <header role="banner">
      <img src="redblue-logo.png" srcset="redblue-logo.png 1x, redblue-logo@2x.png 2x, redblue-logo@3x.png 3x" width="200" height="200" alt="RedBlue logo" />
      <hgroup>
        <h1 class="logotype">RedBlue <span>Annotations</span></h1>
        <h2>Third-Party Embeds</h2>
      </hgroup>
    </header>
    <main>
      <h2>Hotspot Over YouTube Video</h2>
      <nav id="tab-links" class="tab-links">
        <a class="tab-link" href="#xml">XML</a>
        <a class="tab-link" href="#json-ld">JSON-LD</a>
      </nav>
      <article id="xml" class="tab">
        <h3>XML</h3>
        <h4>Code</h4>
        <pre><code id="code-xml" class="xml full-example"></code></pre>
        <h4>Result</h4>
        <redblue-video id="redblue-youtube-xml" aspect-ratio="16:9" debug="debug">
          <hvml
            xmlns="https://hypervideo.tech/hvml#"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            xmlns:css="https://www.w3.org/TR/CSS/"
            xml:lang="en-US"
            hidden="hidden"
          >
            <video type="personal" xml:id="ep-23">
              <title>Overnight Dance Party at the Museum of Fine Arts Boston</title>
              <episode>23</episode>
              <recorded>2016-09-17</recorded>
              <description type="xhtml">
                <div xmlns="http://www.w3.org/1999/xhtml">
                  <p>Full Facebook Live stream: http://hugh.today/2016-09-17/live</p>
                  <p>#mfaNOW #mfaLateNites</p>
                </div>
              </description>
              <showing scope="release" type="internet" admission="private">
                <venue type="site">
                  <entity site="https://www.youtube.com/">YouTube</entity>
                  <uri>https://www.youtube.com/watch?v=nWdWq3hMwao</uri>
                  <title>Overnight Dance Party at the Museum of Fine Arts Boston | Hugh’s Vlog | #mfaNOW #mfaLateNites</title>
                </venue>
              </showing>
              <presentation>
                <choice xml:id="full-stream">
                  <name>Go to: <code style="font-family: inherit; font-weight: bold;">hugh.today/2016-09-17/live</code> for the full stream</name>
                  <goto on="duration" xlink:actuate="onRequest" xlink:href="http://hugh.today/2016-09-17/live" width="70%" height="13%" css:font-size="calc(384 / 150 * 1vw)" css:font-family="'Noto Sans CJK JP', 'Noto Sans CJK', 'Noto Sans', sans-serif" css:white-space="nowrap" css:overflow="hidden">
                    <animate startTime="517.292107" endTime="518.872131" startX="14.9%" startY="-15%" endX="15%" endY="10%"></animate>
                    <animate startTime="523.373882" endTime="524.873404" startX="14.9%" startY="10%" endX="15%" endY="-15%"></animate>
                  </goto>
                </choice>
              </presentation>
            </video>
          </hvml>
        </redblue-video>
      </article>
      <article id="json-ld" class="tab">
        <h3>JSON-LD</h3>
        <h4>Code</h4>
        <pre><code id="code-json-ld" class="xml full-example"></code></pre>
        <h4>Result</h4>
        <redblue-video id="redblue-youtube-json-ld" aspect-ratio="16:9" debug="debug">
          <script type="application/ld+json">
          {
            "@context": "https://redblue.video/examples/hvml.context.jsonld",
            "@type": "video",
            "@id":  "vlog:2016-09-17",
            "xml:id": "ep-23",
            "type": "personal",
            "title": "Overnight Dance Party at the Museum of Fine Arts Boston",
            "episode": 23,
            "recorded": "2016-09-17",
            "description": {
              "html:div": {
                "childNodes": [
                  {
                    "@type": "p",
                    "@value": "Full Facebook Live stream: http://hugh.today/2016-09-17/live"
                  },
                  {
                    "@type": "p",
                    "@value": "#mfaNOW #mfaLateNites"
                  }
                ]
              }
            },
            "showing": {
              "scope": "release",
              "type": "internet",
              "admission": "private",
              "venue": {
                "type": "site",
                "entity": [
                  {
                    "site": "https://www.youtube.com/"
                  },
                  "YouTube"
                ],
                "uri": "https://www.youtube.com/watch?v=nWdWq3hMwao",
                "title": "Overnight Dance Party at the Museum of Fine Arts Boston | Hugh’s Vlog | #mfaNOW #mfaLateNites"
              }
            },
            "presentation": {
              "choice": {
                "name": [
                  "Go to: ",
                  {
                    "@type": "code",
                    "style": "font-family: inherit; font-weight: bold;",
                    "textContent": "hugh.today/2016-09-17/live"
                  },
                  " for the full stream"
                ],
                "goto": {
                  "on": "duration",
                  "xlink:actuate": "onRequest",
                  "xlink:href": "http://hugh.today/2016-09-17/live",
                  "width": "70%",
                  "height": "13%",
                  "css:font-size": "calc(384 / 150 * 1vw)",
                  "css:font-family": "'Noto Sans CJK JP', 'Noto Sans CJK', 'Noto Sans', sans-serif",
                  "css:white-space": "nowrap",
                  "css:overflow": "hidden",
                  "animate": [
                    {
                      "startTime": "517.292107",
                      "endTime": "518.872131",
                      "startX": "14.9%",
                      "startY": "-15%",
                      "endX": "15%",
                      "endY": "10%"
                    },
                    {
                      "startTime": "523.373882",
                      "endTime": "524.873404",
                      "startX": "14.9%",
                      "startY": "10%",
                      "endX": "15%",
                      "endY": "-15%"
                    }
                  ]
                }
              }
            }
          }
          </script>
        </redblue-video>
      </article>
      <article id="fallback">
        <h2>Non-interactive Fallback</h2>
        <p>If you want to provide a fallback video for cases where the user has JavaScript turned off, or the RedBlue player fails to load, you can specify the third-party embed code manually. Just include the embed as a child of <code>redblue-video</code>.</p>
        <pre><code id="code-fallback" class="xml">&lt;redblue-video id="redblue-youtube-fallback" aspect-ratio="16:9" debug="debug"&gt;
  &lt;hvml xmlns="https://hypervideo.tech/hvml#" hidden="hidden"&gt;
    &lt;video&gt;
      &lt;!-- … --&gt;
    &lt;/video&gt;
  &lt;/hvml&gt;
  &lt;iframe
    src="//www.youtube.com/embed/nWdWq3hMwao?rel=0&amp;amp;showinfo=0&amp;amp;start=517&amp;amp;end=527&amp;amp;enablejsapi=1&amp;amp;controls=1&amp;amp;modestbranding=1&amp;amp;playsinline=1&amp;amp;fs=0&amp;amp;origin=http%3A%2F%2Flocal.redblue.video"
    frameborder="0"
    allow="autoplay; encrypted-media"
    allowfullscreen="allowfullscreen"
  &gt;&lt;/iframe&gt;
&lt;/redblue-video&gt;</code></pre>
        <p>If you wish to override RedBlue’s auto-generated embed code with your own even in the full-featured version, you can set the <code>iframe</code>’s <code>slot</code> attribute to <code>player</code>.</p>
      </article>
      <article id="detailed-instructions">
        <h2>Detailed Instructions</h2>
        <h3 id="attaching-a-third-party-embed">Attaching a third-party embed</h3>
        <dl class="instructions">
          <dd class="step">Import the RedBlue video player Custom Element. (This requires ES6 support to work directly in the browser; otherwise the source code can be transpiled to ES5.)</dd>
          <dd class="step step--code"><pre><code class="xml">&lt;script type="module"&gt;
  import RedBlueVideo from './modules/redblue-video-omni.js';
  customElements.define( RedBlueVideo.is, RedBlueVideo );
&lt;/script&gt;</code></pre></dd>
          <dd class="step">Include an <a href="https://hypervideo.tech"><abbr>HVML</abbr></a> code block as a child of <code>&lt;redblue-video&gt;</code>. <abbr>HVML</abbr> can be represented as either <abbr>XML</abbr> or <abbr>JSON-LD</abbr>. When using the <abbr>XML</abbr> serialization, set the boolean <code>hidden</code> attribute to true to prevent the browser from rendering the metadata.</dd>
          <dd class="step step--code"><pre><code class="xml">&lt;redblue-video&gt;
  &lt;hvml xmlns="https://hypervideo.tech/hvml#" hidden="hidden"&gt;&lt;/hvml&gt;
&lt;/redblue-video&gt;</code></pre></dd>
          <dd class="step">In the <abbr>HVML</abbr>, specify a single <code>video</code> element. (Not to be confused with <abbr>HTML</abbr>’s <code>video</code> element—though unless your page is served as <abbr title="application/xhtml+xml">XHTML</abbr>, technically the browser will interpret it as such.) This is the container for all of your video’s metadata.</dd>
          <dd class="step step--code"><pre><code class="xml">&lt;redblue-video&gt;
  &lt;hvml xmlns="https://hypervideo.tech/hvml#" hidden="hidden"&gt;
    <ins>&lt;video&gt;&lt;/video&gt;</ins>
  &lt;/hvml&gt;
&lt;/redblue-video&gt;</code></pre></dd>
          <dd class="step">Under <code>video</code>, include a <code>showing</code> with its <code>scope</code> set to <code>release</code>. This tells the <abbr>HVML</abbr> parser that the video has been shown to an audience (or will be), and that this showing represents its initial release. For movies shown in a theater, there may be more than one showing, such as at different film festivals, but for online videos, there is typically only one.</dd>
          <dd class="step step--code"><pre><code class="xml">&lt;redblue-video&gt;
  &lt;hvml xmlns="https://hypervideo.tech/hvml#" hidden="hidden"&gt;
    &lt;video&gt;
      <ins>&lt;showing scope="release"&gt;&lt;/showing&gt;</ins>
    &lt;/video&gt;
  &lt;/hvml&gt;
&lt;/redblue-video&gt;</code></pre></dd>
          <dd class="step">Under <code>showing</code>, include a <code>venue</code> with its <code>type</code> set to <code>site</code>. This tells the <abbr>HVML</abbr> parser where this showing takes place; in this case, a website.</dd>
          <dd class="step step--code"><pre><code class="xml">&lt;redblue-video&gt;
  &lt;hvml xmlns="https://hypervideo.tech/hvml#" hidden="hidden"&gt;
    &lt;video&gt;
      &lt;showing scope="release"&gt;
        <ins>&lt;venue type="site"&gt;&lt;/venue&gt;</ins>
      &lt;/showing&gt;
    &lt;/video&gt;
  &lt;/hvml&gt;
&lt;/redblue-video&gt;</code></pre></dd>
          <dd class="step">Under <code>venue</code>, include a <code>uri</code> with text matching the appropriate pattern for a third-party video link. The appropriate embed code will be automatically generated and inserted depending on the link pattern.</dd>
          <dd>For YouTube videos, the pattern is <code>//www.youtube.com/watch?v=</code>.</dd>
          <dd>For Vimeo videos, the pattern is <code>//vimeo.com/</code>.</dd>
          <dd class="step step--code"><pre><code class="xml">&lt;redblue-video&gt;
  &lt;hvml xmlns="https://hypervideo.tech/hvml#" hidden="hidden"&gt;
    &lt;video&gt;
      &lt;showing scope="release"&gt;
        &lt;venue type="site"&gt;
          <ins>&lt;uri&gt;https://www.youtube.com/watch?v=nWdWq3hMwao&lt;/uri&gt;</ins>
        &lt;/venue&gt;
      &lt;/showing&gt;
    &lt;/video&gt;
  &lt;/hvml&gt;
&lt;/redblue-video&gt;</code></pre>
          </dd>
        </dl>
        <h3 id="annotating">Annotating</h3>
        <dl class="instructions">
          <dd class="step">To add a “hotspot” link to a specific segment of the video, do this:</dd>
          <dd class="step">Under <code>video</code>, include a <code>presentation</code> element. This is the container for instructions telling the <abbr>HVML</abbr> parser how to present a video on playback.</dd>
          <dd class="step step--code"><pre><code class="xml">&lt;redblue-video&gt;
  &lt;hvml xmlns="https://hypervideo.tech/hvml#" hidden="hidden"&gt;
    &lt;video&gt;
      &lt;showing scope="release"&gt;
        &lt;venue type="site"&gt;
          &lt;uri&gt;https://www.youtube.com/watch?v=nWdWq3hMwao&lt;/uri&gt;
        &lt;/venue&gt;
      &lt;/showing&gt;
      <ins>&lt;presentation&gt;&lt;/presentation&gt;</ins>
    &lt;/video&gt;
  &lt;/hvml&gt;
&lt;/redblue-video&gt;</code></pre></dd>
          <dd class="step">Under <code>presentation</code>, include a <code>choice</code> element for each hotspot you want to create.</dd>
          <dd class="step step--code"><pre><code class="xml">&lt;redblue-video&gt;
  &lt;hvml xmlns="https://hypervideo.tech/hvml#" hidden="hidden"&gt;
    &lt;video&gt;
      &lt;showing scope="release"&gt;
        &lt;venue type="site"&gt;
          &lt;uri&gt;https://www.youtube.com/watch?v=nWdWq3hMwao&lt;/uri&gt;
        &lt;/venue&gt;
      &lt;/showing&gt;
      &lt;presentation&gt;
        <ins>&lt;choice&gt;&lt;/choice&gt;</ins>
      &lt;/presentation&gt;
    &lt;/video&gt;
  &lt;/hvml&gt;
&lt;/redblue-video&gt;</code></pre></dd>
          <dd class="step">Under <code>choice</code>, include a <code>name</code> specifying the hotspot’s link text. In the <abbr>XML</abbr> serialization of <abbr>HVML</abbr>, This can directly include <abbr>HTML</abbr> markup. However, <code>a</code> tags are not supported, as the hotspot will be generated as an <code>a</code> tag itself in the final product.</dd>
          <dd class="step step--code"><pre><code class="xml">&lt;redblue-video&gt;
  &lt;hvml xmlns="https://hypervideo.tech/hvml#" hidden="hidden"&gt;
    &lt;video&gt;
      &lt;showing scope="release"&gt;
        &lt;venue type="site"&gt;
          &lt;uri&gt;https://www.youtube.com/watch?v=nWdWq3hMwao&lt;/uri&gt;
        &lt;/venue&gt;
      &lt;/showing&gt;
      &lt;presentation&gt;
        &lt;choice&gt;
          <ins>&lt;name&gt;Go to: &lt;code&gt;hugh.today/2016-09-17/live&lt;/code&gt; for the full stream&lt;/name&gt;</ins>
        &lt;/choice&gt;
      &lt;/presentation&gt;
    &lt;/video&gt;
  &lt;/hvml&gt;
&lt;/redblue-video&gt;</code></pre></dd>
          <dd class="step">Under <code>choice</code>, include a <code>goto</code>, which specifies a hyperlink action to perform.</dd>
          <dd>Set its <code>on</code> attribute to <code>duration</code>, which specifies that this hotspot is triggered by the viewer arriving at a specific duration range in the timeline.</dd>
          <dd>Set its <code>xlink:href</code> attribute to the <abbr>URL</abbr> you wish to link to.</dd>
          <dd>Set its <code>xlink:actuate</code> attribute to <code>onRequest</code>, which specifies that the link should be activated when clicked or tapped on, rather than automatically.</dd>
          <dd>Since we are using XLink-namespaced attributes, define the XLink namespace on the root <code>hvml</code> element.</dd>
          <dd class="step step--code"><pre><code class="xml">&lt;redblue-video&gt;
  &lt;hvml xmlns="https://hypervideo.tech/hvml#" <ins>xmlns:xlink="http://www.w3.org/1999/xlink"</ins> hidden="hidden"&gt;
    &lt;video&gt;
      &lt;showing scope="release"&gt;
        &lt;venue type="site"&gt;
          &lt;uri&gt;https://www.youtube.com/watch?v=nWdWq3hMwao&lt;/uri&gt;
        &lt;/venue&gt;
      &lt;/showing&gt;
      &lt;presentation&gt;
        &lt;choice&gt;
          &lt;name&gt;Go to: &lt;code&gt;hugh.today/2016-09-17/live&lt;/code&gt; for the full stream&lt;/name&gt;
          <ins>&lt;goto on="duration" xlink:actuate="onRequest" xlink:href="http://hugh.today/2016-09-17/live"&gt;&lt;/goto&gt;</ins>
        &lt;/choice&gt;
      &lt;/presentation&gt;
    &lt;/video&gt;
  &lt;/hvml&gt;
&lt;/redblue-video&gt;</code></pre></dd>
          <dd class="step">Under <code>goto</code>, include an <code>animate</code> element for every transition from one state to another that you want the hotspot to go through.</dd>
          <dd>Set its <code>startTime</code> and <code>endTime</code> attributes to the video times in seconds you want the transition to start and end respectively.</dd>
          <dd>Set its <code>startX</code> and <code>endX</code> attributes to the x-axis coordinates, specified as a percentage relative to the video container starting from the left, that you want the transition to start at and move to respectively.</dd>
          <dd>Set its <code>startY</code> and <code>endY</code> attributes to the y-axis coordinates, specified as a percentage relative to the video container starting from the bottom, that you want the transition to start at and move to respectively.</dd>
          <dd class="step step--code"><pre><code class="xml">&lt;redblue-video&gt;
  &lt;hvml xmlns="https://hypervideo.tech/hvml#" xmlns:xlink="http://www.w3.org/1999/xlink" hidden="hidden"&gt;
    &lt;video&gt;
      &lt;showing scope="release"&gt;
        &lt;venue type="site"&gt;
          &lt;uri&gt;https://www.youtube.com/watch?v=nWdWq3hMwao&lt;/uri&gt;
        &lt;/venue&gt;
      &lt;/showing&gt;
      &lt;presentation&gt;
        &lt;choice&gt;
          &lt;name&gt;Go to: &lt;code&gt;hugh.today/2016-09-17/live&lt;/code&gt; for the full stream&lt;/name&gt;
          &lt;goto on="duration" xlink:actuate="onRequest" xlink:href="http://hugh.today/2016-09-17/live"&gt;
            <ins>&lt;animate startTime="517.292107" endTime="518.872131" startX="14.9%" startY="-15%" endX="15%" endY="10%"&gt;&lt;/animate&gt;
              &lt;animate startTime="523.373882" endTime="524.873404" startX="14.9%" startY="10%" endX="15%" endY="-15%"&gt;&lt;/animate&gt;</ins>
          &lt;/goto&gt;
        &lt;/choice&gt;
      &lt;/presentation&gt;
    &lt;/video&gt;
  &lt;/hvml&gt;
&lt;/redblue-video&gt;</code></pre></dd>

        </dl>
      </article>
    </main>
    <div id="scripts">
      <script id="hljs" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
      <script id="hljs-xml" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/xml.min.js"></script>
      <script id="page">
      // (function () {
        'use strict';

        const highlightCode = () => {
          const $codeXML = document.getElementById( 'code-xml' );
          const $codeJSONLD = document.getElementById( 'code-json-ld' );
          const extraWhitespace8 = /\n\s{8}/gi;
          const extraWhitespace6 = /\n\s{6}/gi;
          const closingTag = /\n\s*(<\/redblue-video>)/gi;

          if ( $codeXML ) {
            $codeXML.textContent = document.getElementById( 'redblue-youtube-xml' ).outerHTML
              .replace( extraWhitespace8, '\n    ' )
              .replace( extraWhitespace6, '\n   ' )
              .replace( closingTag, '\n$1' )
            ;
          }

          if ( $codeJSONLD ) {
            $codeJSONLD.textContent = document.getElementById( 'redblue-youtube-json-ld' ).outerHTML
              .replace( extraWhitespace8, '\n    ' )
              .replace( extraWhitespace6, '\n   ' )
              .replace( closingTag, '\n$1' )
            ;
          }

          hljs.initHighlighting();
        };
        const scrolled = false;
        const $tabLinks = document.getElementById( 'tab-links' );

        const scrollBack = function ( event ) {
          const offsets = [ window.pageXOffset, window.pageYOffset ];
          event.preventDefault();
          window.location.hash = event.target.getAttribute( 'href' );
          window.scrollTo( offsets[0], offsets[1] );
        };

        if ( window.location.hash === '' ) {
          setTimeout( () => {
            scrollBack( {
              "preventDefault": function () {},
              "target": {
                "getAttribute": function () {
                  return '#xml';
                }
              }
            } );
          }, 1000 );
        } else {
          window.scrollTo( 0, 0 );
        }

        $tabLinks.addEventListener( 'click', scrollBack, false );
        // window.addEventListener( 'hashchange', scrollBack, false );

        highlightCode();
      // })();
      </script>
      <!-- Omni-Parser Config (XML + JSON-LD) -->
      <script type="module">
        import RedBlueVideo from './modules/redblue-video-omni.js';
        customElements.define( RedBlueVideo.is, RedBlueVideo );
      </script>
      <!-- Omni-Parser Config with Custom JSON Search -->
      <!-- <script type="module">
        import RedBlueVideo from './modules/redblue-video.js';
        import RedBlueXMLParser from './modules/parser-xml.js';
        import RedBlueJSONLDParser from './modules/parser-json-ld.js';
        RedBlueJSONLDParser.customJSONSearchUtility = function ( xpathExpression, contextNode, namespaceResolver, resultType, result ) {
          const params = { xpathExpression, contextNode, namespaceResolver, resultType, result };
          console.log( 'params', params );
          return params;
        };
        const RedBlueVideoOmni = RedBlueJSONLDParser( RedBlueXMLParser( RedBlueVideo ) );
        customElements.define( RedBlueVideoOmni.is, RedBlueVideoOmni );
      </script> -->
    </div>
    <footer>
      <p><a href="https://github.com/RedBlueVideo/redblue/tree/web-components">Github</a> | <a href="http://twitter.com/RedBlueVideo">Twitter</a></p>
      <p>RedBlue source code is licensed under the <a href="https://github.com/RedBlueVideo/redblue/blob/web-components/LICENSE.txt">GNU <abbr title="General Public License">GPL</abbr> v3.0</a>.</p>
      <p>The RedBlue logo is © 2014–2018 RedBlue Corporation.</p>
    </footer>
    <style scoped>
      @font-face {
        font-family: 'Accord Alternate';
        src: url('/style/AccordAlternate_Med-webfont.woff2') format('woff2'),
             url('/style/AccordAlternate_Med-webfont.woff') format('woff');
        font-weight: 600;
        font-style: normal;
      }

      @font-face {
        font-family: 'Accord Alternate';
        src: url('/style/AccordAlternate_Reg-webfont.woff2') format('woff2'),
             url('/style/AccordAlternate_Reg-webfont.woff') format('woff');
        font-weight: normal;
        font-style: normal;
      }
    </style>
  </body>
</html>
<!--
  Design considerations:
  • Does `playlist` make sense to mark up annotations *within* a video,
    or is it only for “meta-videos”, i.e. those that embed other videos?
  • `playlist type="nonlinear"` is only required if sibling actions
    (`goto`, `playlistAction`, `media`) are not guranteed to execute.
  • `playlist type="linear"` means that all actions are guaranteed to
    execute provided the user encounters their triggers (typically duration)
  • If a video only has one action, is `playlist` required?
-->
